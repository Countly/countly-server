// Countly Dashboard Entrypoint
// This file serves as the main entry point for the Vite bundler

// =============================================================================
// CSS/SCSS IMPORTS (from Gruntfile.js cssmin and sass tasks)
// =============================================================================

// Main stylesheets
import './stylesheets/main.css';
import './stylesheets/vue/clyvue.scss';
import './stylesheets/leaflet/leaflet.css';
import './stylesheets/vue/vue-json-pretty.css';
import './javascripts/dom/gridstack/gridstack.css';
import './javascripts/dom/pace/pace-theme-flash.css';
import './stylesheets/bulma/bulma-custom.css';
import './stylesheets/styles/manifest.scss';
import './stylesheets/vue/element-tiptap.css';

// Plugin stylesheets
// import.meta.glob('../../../plugins/*/frontend/public/stylesheets/**/*.scss', { eager: true });
import.meta.glob('../../../plugins/*/frontend/public/stylesheets/**/*.css');

import "./imports.js";

import { setupCountlyWebSDK } from './javascripts/web-sdk-setup.js';

// =============================================================================
// LEGACY SCRIPT IMPORTS
// =============================================================================

// Import all legacy scripts concatenated into a single shared scope
// This virtual module is generated by the legacyConcatPlugin in vite.config.js
// All legacy scripts share the same scope and can access each other's variables
import 'virtual:legacy-concat';

// Component imports
import ClyStatusBadge from './javascripts/components/cly-status-badge.vue';
import ClyTabs from './javascripts/components/nav/cly-tabs.vue';
import ClyDynamicTabs from './javascripts/components/nav/cly-dynamic-tabs.vue';

// Form component imports
import ClyForm from './javascripts/components/form/cly-form.vue';
import ClyFormStep from './javascripts/components/form/cly-form-step.vue';
import ClyFormField from './javascripts/components/form/cly-form-field.vue';
import ClyFormFieldGroup from './javascripts/components/form/cly-form-field-group.vue';
import ClyInlineFormField from './javascripts/components/form/cly-inline-form-field.vue';
import ClyFormFieldChecklistbox from './javascripts/components/form/cly-form-field-checklistbox.vue';

// Drawer component imports
import ClyDrawer from './javascripts/components/drawer/cly-drawer.vue';

// Layout component imports
import ClyGuide from './javascripts/components/layout/cly-guide.vue';
import ClyHeader from './javascripts/components/layout/cly-header.vue';
import ClyMain from './javascripts/components/layout/cly-main.vue';
import ClySection from './javascripts/components/layout/cly-section.vue';
import ClySubSection from './javascripts/components/layout/cly-sub-section.vue';

// Content component imports
import ClyContentLayout from './javascripts/components/content/cly-content-layout.vue';
import ClyContentHeader from './javascripts/components/content/cly-content-header.vue';
import ClyContentBody from './javascripts/components/content/cly-content-body.vue';
import ClyContentBuilderSidebarStep from './javascripts/components/content/cly-content-builder-sidebar-step.vue';
import ClyContentBuilderSidebarInput from './javascripts/components/content/cly-content-builder-sidebar-input.vue';
import ClyContentBlockListInput from './javascripts/components/content/cly-content-block-list-input.vue';
import ClyOptionSwapper from './javascripts/components/content/cly-option-swapper.vue';
import ClyDeviceSelector from './javascripts/components/content/cly-device-selector.vue';

// Dialog component imports
import ClyDialog from './javascripts/components/dialog/cly-dialog.vue';
import ClyConfirmDialog from './javascripts/components/dialog/cly-confirm-dialog.vue';
import ClyMessageDialog from './javascripts/components/dialog/cly-message-dialog.vue';
import ClyFormDialog from './javascripts/components/dialog/cly-form-dialog.vue';

// Register components globally
window.Vue.component('cly-status-badge', ClyStatusBadge);
window.Vue.component('cly-tabs', ClyTabs);
window.Vue.component('cly-dynamic-tabs', ClyDynamicTabs);

// Register form components globally
window.Vue.component('cly-form', ClyForm);
window.Vue.component('cly-form-step', ClyFormStep);
window.Vue.component('cly-form-field', ClyFormField);
window.Vue.component('cly-form-field-group', ClyFormFieldGroup);
window.Vue.component('cly-inline-form-field', ClyInlineFormField);
window.Vue.component('cly-form-field-checklistbox', ClyFormFieldChecklistbox);

// Register drawer components globally
window.Vue.component('cly-drawer', ClyDrawer);

// Register layout components globally
window.Vue.component('cly-guide', ClyGuide);
window.Vue.component('cly-header', ClyHeader);
window.Vue.component('cly-main', ClyMain);
window.Vue.component('cly-section', ClySection);
window.Vue.component('cly-sub-section', ClySubSection);

// Register content components globally
window.Vue.component('cly-content-layout', ClyContentLayout);
window.Vue.component('cly-content-header', ClyContentHeader);
window.Vue.component('cly-content-body', ClyContentBody);
window.Vue.component('cly-content-builder-sidebar-step', ClyContentBuilderSidebarStep);
window.Vue.component('cly-content-builder-sidebar-input', ClyContentBuilderSidebarInput);
window.Vue.component('cly-content-block-list-input', ClyContentBlockListInput);
window.Vue.component('cly-option-swapper', ClyOptionSwapper);
window.Vue.component('cly-device-selector', ClyDeviceSelector);

// Register dialog components globally
window.Vue.component('cly-dialog', ClyDialog);
window.Vue.component('cly-confirm-dialog', ClyConfirmDialog);
window.Vue.component('cly-message-dialog', ClyMessageDialog);
window.Vue.component('cly-form-dialog', ClyFormDialog);

// =============================================================================
// NEW ES MODULE CODE GOES BELOW
// =============================================================================
//
// From here onwards, you can use standard ES module import/export syntax.
// All legacy globals (like $, _, Backbone, Vue, countlyGlobal, countlyCommon, etc.)
// are available on the window object after the legacy scripts execution.
//
// Example usage:
//
// import { MyNewModule } from './javascripts/modules/my-new-module.js';
// import { SomeHelper } from './javascripts/helpers/some-helper.js';
//
// The legacy code can still be accessed via window:
// const $ = window.jQuery;
// const Vue = window.Vue;
// const countlyCommon = window.countlyCommon;
//
// =============================================================================

// Start Backbone history for routing
import Backbone from './javascripts/utils/backbone-min.js';
Backbone.history.start();

// Setup Countly Web SDK
setupCountlyWebSDK();