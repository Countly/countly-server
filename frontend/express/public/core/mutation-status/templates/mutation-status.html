<div v-bind:class="[componentId]" class="mutation-status-view">
    <cly-header
        :title="i18n('mutation-status.overview.title')"
        :tooltip="{description: i18n('mutation-status.overview.tooltip')}"
    >
        <!-- <template v-slot:header-bottom>
            <i class="cly-io cly-io-clock color-cool-gray-50 bu-mr-1"></i>
            <span class="text-medium color-cool-gray-50 bu-mr-2">16 hours ago</span>
        </template> -->
    </cly-header>

    <cly-main>
        <cly-section>
            <cly-datatable-n :rows="mutationStatusData" :force-loading="isLoading">
                <template v-slot="scope">
                    <el-table-column fixed="left" width="150" sortable="custom" prop="status" :label="i18n('mutation-status.table.status')">
                        <template v-slot="rowScope">
                            <div v-tooltip="i18n('mutation-status.table.completed-at', formatDate(rowScope.row.mutation_completion_ts))">
                                <cly-status-tag
                                    :text="rowScope.row.status.toUpperCase()"
                                    :color="rowScope.row.status === 'failed' ? 'red' : (rowScope.row.status === 'completed' ? 'green' : 'yellow')">
                                </cly-status-tag>
                            </div>
                        </template>
                    </el-table-column>
                    <el-table-column sortable="custom" prop="db" :label="i18n('mutation-status.table.database')" min-width="180">
                        <template v-slot="rowScope">
                            <div> {{ rowScope.row.db }} </div>
                        </template>
                    </el-table-column>
                    <el-table-column sortable="custom" prop="collection" :label="i18n('mutation-status.table.collection')" min-width="200">
                        <template v-slot="rowScope">
                            <div> {{ rowScope.row.collection }} </div>
                        </template>
                    </el-table-column>
                    <el-table-column sortable="custom" prop="query" :label="i18n('mutation-status.table.query')" min-width="320">
                        <template v-slot="rowScope">
                            <div v-tooltip="{content: JSON.stringify(rowScope.row.query)}">
                                <code> {{ rowScope.row.query }} </code>
                            </div>
                        </template>
                    </el-table-column>
                    <el-table-column sortable="custom" prop="type" :label="i18n('mutation-status.table.type')" min-width="140">
                        <template v-slot="rowScope">
                            <div> {{ rowScope.row.type }} </div>
                        </template>
                    </el-table-column>
                    <el-table-column sortable="custom" prop="ts" :label="i18n('mutation-status.table.timestamp')" min-width="200">
                        <template v-slot="rowScope">
                            <div> {{ formatDate(rowScope.row.ts) }} </div>
                        </template>
                    </el-table-column>
                    <el-table-column sortable="custom" prop="running" :label="i18n('mutation-status.table.running')" min-width="140">
                        <template v-slot="rowScope">
                            <div> {{ rowScope.row.running }} </div>
                        </template>
                    </el-table-column>
                    <el-table-column sortable="custom" prop="error" :label="i18n('mutation-status.table.error')" min-width="280">
                        <template v-slot="rowScope">
                            <div> {{ rowScope.row.error }} </div>
                        </template>
                    </el-table-column>
                    <el-table-column sortable="custom" prop="fail_count" :label="i18n('mutation-status.table.attempts')" min-width="140">
                        <template v-slot="rowScope">
                            <div> {{ rowScope.row.fail_count }} </div>
                        </template>
                    </el-table-column>
                    <el-table-column sortable="custom" prop="retryAt" :label="i18n('mutation-status.table.retry-at')" min-width="200">
                        <template v-slot="rowScope">
                            <div> {{ formatDate(rowScope.row.retryAt) }} </div>
                        </template>
                    </el-table-column>
                </template>
            </cly-datatable-n>
        </cly-section>
    </cly-main>
</div>
