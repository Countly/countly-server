# Kafka Non-Sensitive Configuration
# Performance, optimization, and behavior settings based on config.sample.js
# 
# ⚠️  IMPORTANT: When Kafka is enabled, it becomes a HARD DEPENDENCY.
# Any connection failures during startup will cause the application to exit.

# Application-level Kafka settings
COUNTLY_CONFIG__KAFKA_ENABLED=true
COUNTLY_CONFIG__KAFKA_DRILLEVENTSTOPIC=countly-drill-events

# Consumer group ID prefix (customize for multi-tenant deployments)
COUNTLY_CONFIG__KAFKA_GROUPIDPREFIX=cly_

# Topic configuration
COUNTLY_CONFIG__KAFKA_PARTITIONS=10
COUNTLY_CONFIG__KAFKA_REPLICATIONFACTOR=1
COUNTLY_CONFIG__KAFKA_RETENTIONMS=604800000

# Transaction settings
COUNTLY_CONFIG__KAFKA_ENABLETRANSACTIONS=false
COUNTLY_CONFIG__KAFKA_TRANSACTIONTIMEOUT=60000

# librdkafka connection settings (non-sensitive)
COUNTLY_CONFIG__KAFKA_RDKAFKA_CLIENTID=countly-kafka-client
COUNTLY_CONFIG__KAFKA_RDKAFKA_REQUESTTIMEOUTMS=30000
COUNTLY_CONFIG__KAFKA_RDKAFKA_CONNECTIONTIMEOUTMS=10000
COUNTLY_CONFIG__KAFKA_RDKAFKA_LINGERMS=5
COUNTLY_CONFIG__KAFKA_RDKAFKA_RETRIES=8
COUNTLY_CONFIG__KAFKA_RDKAFKA_INITIALRETRYTIME=100
COUNTLY_CONFIG__KAFKA_RDKAFKA_MAXRETRYTIME=30000
COUNTLY_CONFIG__KAFKA_RDKAFKA_ACKS=-1

# Producer optimization settings
COUNTLY_CONFIG__KAFKA_PRODUCER_BATCHSIZE=1048576
COUNTLY_CONFIG__KAFKA_PRODUCER_BATCHNUMMESSAGES=10000
COUNTLY_CONFIG__KAFKA_PRODUCER_QUEUEBUFFERINGMAXMESSAGES=100000
COUNTLY_CONFIG__KAFKA_PRODUCER_QUEUEBUFFERINGMAXKBYTES=1048576
COUNTLY_CONFIG__KAFKA_PRODUCER_COMPRESSIONLEVEL=1
COUNTLY_CONFIG__KAFKA_PRODUCER_MESSAGETIMEOUTMS=300000
COUNTLY_CONFIG__KAFKA_PRODUCER_DELIVERYTIMEOUTMS=300000

# Consumer optimization settings
COUNTLY_CONFIG__KAFKA_CONSUMER_FETCHMINBYTES=1024
COUNTLY_CONFIG__KAFKA_CONSUMER_FETCHMAXWAITMS=500
COUNTLY_CONFIG__KAFKA_CONSUMER_FETCHMAXBYTES=52428800
COUNTLY_CONFIG__KAFKA_CONSUMER_MAXPARTITIONFETCHBYTES=1048576
COUNTLY_CONFIG__KAFKA_CONSUMER_QUEUEDMINMESSAGES=100000
COUNTLY_CONFIG__KAFKA_CONSUMER_QUEUEDMAXMESSAGESKBYTES=1048576
COUNTLY_CONFIG__KAFKA_CONSUMER_SESSIONTIMEOUTMS=30000
COUNTLY_CONFIG__KAFKA_CONSUMER_MAXPOLLINTERVALMS=300000
COUNTLY_CONFIG__KAFKA_CONSUMER_AUTOOFFSETRESET=latest
COUNTLY_CONFIG__KAFKA_CONSUMER_ENABLEAUTOCOMMIT=false

# Consumer error handling settings
COUNTLY_CONFIG__KAFKA_CONSUMER_INVALIDJSONBEHAVIOR=skip
COUNTLY_CONFIG__KAFKA_CONSUMER_INVALIDJSONMETRICS=true