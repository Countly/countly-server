# ClickHouse Non-Sensitive Configuration
# Performance, optimization, and behavior settings based on config.sample.js

# Connection pool and timeout settings
COUNTLY_CONFIG__CLICKHOUSE_REQUEST_TIMEOUT=1200000
COUNTLY_CONFIG__CLICKHOUSE_MAX_OPEN_CONNECTIONS=10
COUNTLY_CONFIG__CLICKHOUSE_APPLICATION=countly_drill

# Compression settings (disabled for better performance in local network)
COUNTLY_CONFIG__CLICKHOUSE_COMPRESSION_REQUEST=false
COUNTLY_CONFIG__CLICKHOUSE_COMPRESSION_RESPONSE=false

# Keep-alive settings for connection reuse
COUNTLY_CONFIG__CLICKHOUSE_KEEP_ALIVE_ENABLED=true
COUNTLY_CONFIG__CLICKHOUSE_KEEP_ALIVE_IDLE_SOCKET_TTL=10000

# ClickHouse server settings for optimal performance
# These settings are passed to ClickHouse with each query

# Connection and timeout settings
COUNTLY_CONFIG__CLICKHOUSE_CLICKHOUSE_SETTINGS_IDLE_CONNECTION_TIMEOUT=11000

# Async insert for high throughput (fire-and-forget mode)
COUNTLY_CONFIG__CLICKHOUSE_CLICKHOUSE_SETTINGS_ASYNC_INSERT=1
COUNTLY_CONFIG__CLICKHOUSE_CLICKHOUSE_SETTINGS_WAIT_FOR_ASYNC_INSERT=1
COUNTLY_CONFIG__CLICKHOUSE_CLICKHOUSE_SETTINGS_WAIT_END_OF_QUERY=1

# Insert optimization
COUNTLY_CONFIG__CLICKHOUSE_CLICKHOUSE_SETTINGS_OPTIMIZE_ON_INSERT=1

# Query optimization settings
COUNTLY_CONFIG__CLICKHOUSE_CLICKHOUSE_SETTINGS_ALLOW_SUSPICIOUS_TYPES_IN_GROUP_BY=1
COUNTLY_CONFIG__CLICKHOUSE_CLICKHOUSE_SETTINGS_ALLOW_SUSPICIOUS_TYPES_IN_ORDER_BY=1
COUNTLY_CONFIG__CLICKHOUSE_CLICKHOUSE_SETTINGS_OPTIMIZE_MOVE_TO_PREWHERE=1
COUNTLY_CONFIG__CLICKHOUSE_CLICKHOUSE_SETTINGS_QUERY_PLAN_OPTIMIZE_LAZY_MATERIALIZATION=1

# Required for JSON columns in drill_events table
COUNTLY_CONFIG__CLICKHOUSE_CLICKHOUSE_SETTINGS_ALLOW_EXPERIMENTAL_OBJECT_TYPE=1

# Additional performance settings (optional, uncomment to customize)
# COUNTLY_CONFIG__CLICKHOUSE_CLICKHOUSE_SETTINGS_MAX_THREADS=0
# COUNTLY_CONFIG__CLICKHOUSE_CLICKHOUSE_SETTINGS_MAX_MEMORY_USAGE=10000000000
# COUNTLY_CONFIG__CLICKHOUSE_CLICKHOUSE_SETTINGS_MAX_INSERT_BLOCK_SIZE=1000000
# COUNTLY_CONFIG__CLICKHOUSE_CLICKHOUSE_SETTINGS_MIN_INSERT_BLOCK_SIZE_ROWS=1000000
# COUNTLY_CONFIG__CLICKHOUSE_CLICKHOUSE_SETTINGS_MIN_INSERT_BLOCK_SIZE_BYTES=268435456
# COUNTLY_CONFIG__CLICKHOUSE_CLICKHOUSE_SETTINGS_ASYNC_INSERT_MAX_DATA_SIZE=200000000
# COUNTLY_CONFIG__CLICKHOUSE_CLICKHOUSE_SETTINGS_ASYNC_INSERT_BUSY_TIMEOUT_MS=60000
# COUNTLY_CONFIG__CLICKHOUSE_CLICKHOUSE_SETTINGS_ASYNC_INSERT_STALE_TIMEOUT_MS=60000