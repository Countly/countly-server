<cly-drawer 
    @submit="onSubmit"
    @close="onClose"
    ref="eventDrawer"
    :title="title"
    :saveButtonLabel="saveButtonLabel"
    v-bind="$props.controls">
    <template v-slot:default="drawerScope">
        <cly-form-step id="create-event-form" name="First Step">

            <cly-form-field label="Enter Name">
                    <el-input
                        v-model="drawerScope.editedObject.name"
                        placeholder="Event Name">
                    </el-input>
            </cly-form-field>

            <cly-form-field label="Event Key" rules="required">
                <el-input
                :disabled="drawerScope.editedObject.isEditMode"
                class="bu-mb-3" 
                v-model="drawerScope.editedObject.key" 
			    placeholder="Enter Event Key">
			    </el-input>
            </cly-form-field>

            <div class="text-big text-heading bu-mt-2 bu-mb-1">Event Details</div>

            <cly-form-field label="Event Description" :optional="true">
                <el-input
                type="textarea"
                :rows="2"
                placeholder="Enter your description"
                v-model="drawerScope.editedObject.description">
                </el-input>
            </cly-form-field>

            <div v-if="isDrill">
                <cly-form-field label="Category" :optional="true">
                    <cly-select-x
                        class="bu-pt-1"
                        search-placeholder="Search Category"
                        placeholder="Uncategorized" 
                        v-model="drawerScope.editedObject.category"
                        :auto-commit="!autoCommitDisabled" 
                        :mode="selectX.mode"
                        :hide-all-options-tab="allOptionsTabHidden"
                        :options="categories">
                    </cly-select-x>
                </cly-form-field>
            </div>

            <div v-if='drawerScope.editedObject.isEditMode'>
                <div v-if="isDrill">
                    <cly-form-field label="Status">
                        <el-select class="bu-pt-1" v-model="drawerScope.editedObject.status" >
                            <el-option v-for="item in statusList" :key="item.value" :value="item.value">
                            </el-option>
                        </el-select>
                    </cly-form-field>
                </div>

                <cly-form-field label="Visibility">
                    <el-select class="bu-pt-1" v-model="drawerScope.editedObject.is_visible" >
                        <el-option :value=true label="Visible">
                        </el-option>
                        <el-option :value=false label="Hidden">
                        </el-option>
                    </el-select>
                </cly-form-field>

                <div class="text-big text-heading bu-mt-4 bu-pt-1">Event Properties</div>

                <cly-form-field class="bu-pt-0" label="Display Name for Count" subheading="A display name for the count property of this event">
                    <el-input
                    v-model="drawerScope.editedObject.count" 
			        placeholder="Count">
			        </el-input>
                </cly-form-field>

                <cly-form-field label="Display Name for Sum" :optional="true" subheading="A display name for the sum property of this event">
                    <el-input
                    v-model="drawerScope.editedObject.sum" 
                    placeholder="Sum">
                    </el-input>
                </cly-form-field>

                <cly-form-field label="Display Name for Duration" :optional="true" subheading="A display name for the duration property of this event">
                    <el-input
                    v-model="drawerScope.editedObject.dur" 
                    placeholder="Duration">
                    </el-input>
                </cly-form-field>
            </div>

            <div v-if="drawerScope.editedObject.isEditMode">
                <cly-form-field label="Omit Segments" 
                subheading="It allows to delete segmentations from aggregated data only, and keep recording to granular data as string. Omitted segments will not be saved in the future and past data for these segments will be purged immediately after you save these settings. Data for omitted segments will still be stored in Drill.">
                    <el-select multiple v-model="omitList" >
                        <el-option v-for="item in drawerScope.editedObject.segments" :key="item.name" :value="item.name">
                        </el-option>
                    </el-select>
                </cly-form-field>
            </div>

            <div v-if="isDrill" class="bu-mt-1">
                <div class="text-big text-heading bu-pt-4">Event Segmentation</div>
                <data-manager-create-segment
                ref="segments"
			    :max-segments="20"
			    v-model="drawerScope.editedObject.segments"
                ></data-manager-create-segment>
            </div>
        </cly-form-step>
    </template>
</cly-drawer>