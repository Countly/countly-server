<div v-bind:class="[componentId]">
    <cly-header :isHeaderTop=true :title="templateInformations.templateName">
        <template v-slot:header-top>
            <cly-back-link :title="i18n('populator.back-to-template')"></cly-back-link>
        </template>
        <template v-slot:header-left>
            <div class="bu-is-flex bu-is-flex-direction-column">
                <div class="bu-is-flex bu-is-align-items-center">
                    <h3 class="crashes-crashgroup-header__name" v-html="templateInformations.templateName"></h3>
                </div>
                <div class="bu-mt-4 bu-is-flex">
                    <div class="bu-level-item color-cool-gray-50 text-medium">
                        <span>
                            <i class="far fa-clock"></i>
                            {{i18n('populator.generated-on')}}
                        </span>
                        <span class="bu-ml-1">
                            {{templateInformations.generatedOn}}
                        </span>
                    </div>
                </div>
            </div>
        </template>
        <template v-slot:header-right>
            <div v-if="hasDeleteRight" class="bu-level-item">
                <el-button type="success" @click="deleteEnvironment"
                    size="small">{{i18n('populator.delete-environment')}}
                </el-button>
            </div>
        </template>
    </cly-header>
    <cly-main>
        <cly-section>
            <cly-confirm-dialog @cancel="closeConfirmDialog" @confirm="submitConfirmDialog" :visible.sync="dialog.showDialog" dialogType="success" :saveButtonLabel="dialog.saveButtonLabel" :cancelButtonLabel="dialog.cancelButtonLabel" :title="dialog.title" :show-close="false">
                <template slot-scope="scope">
                    <div v-html="dialog.text"></div>
                </template>
            </cly-confirm-dialog>
            <cly-datatable-n id="populator-environment-table" :rows="environmentInformations" :force-loading="isLoading" searchPlaceholder="Search in Environment" :hasExport="false">
                <template v-slot:header-left>
                    <el-select v-model="environmentId">
                        <el-option v-for="item in filterByEnvironmentOptions" :key="item.value" :label="item.label" :value="item.value"></el-option>
                    </el-select>
                </template>
                <template v-slot="scope">
                    <div>
                        <el-table-column fixed="left" :width="calculateWidth(30)" sortable="true" prop="userName" :label="i18n('populator.user-name')">
                            <template v-slot="rowScope">
                                <div>
                                    {{rowScope.row.userName}}
                                </div>
                            </template>
                        </el-table-column>
                        <el-table-column sortable="true" :width="calculateWidth(20)"  prop="platform" :label="i18n('populator.platform')">
                            <template v-slot="rowScope">
                                <div>
                                    {{rowScope.row.platform}}
                                </div>
                            </template>
                        </el-table-column>
                        <el-table-column sortable="true" :width="calculateWidth(20)" prop="device" :label="i18n('populator.device')">
                            <template v-slot="rowScope">
                                <div>
                                    {{rowScope.row.device}}
                                </div>
                            </template>
                        </el-table-column>
                    </div>
                    <div v-for="(item, index) in customProperties">
                        <el-table-column :width="calculateWidth(15)" sortable="true" :prop="item" :label="item">
                            <template v-slot="rowScope">
                                <div>
                                    {{rowScope.row.custom[item] === null || typeof rowScope.row.custom[item] === 'undefined' ? '-' : rowScope.row.custom[item]}}
                                </div>
                            </template>
                        </el-table-column>
                    </div>
                </template>
            </cly-datatable-n>
        </cly-section>
    </cly-main>
</div>