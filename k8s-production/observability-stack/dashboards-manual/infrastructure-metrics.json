{
    "annotations": {
        "list": [
            {
                "builtIn": 1,
                "datasource": {
                    "type": "grafana",
                    "uid": "-- Grafana --"
                },
                "enable": true,
                "hide": true,
                "iconColor": "rgba(0, 211, 255, 1)",
                "name": "Annotations & Alerts",
                "type": "dashboard"
            }
        ]
    },
    "description": "Detailed infrastructure metrics for all services.",
    "editable": true,
    "fiscalYearStartMonth": 0,
    "graphTooltip": 1,
    "id": null,
    "links": [],
    "liveNow": false,
    "panels": [
        {
            "collapsed": false,
            "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 0
            },
            "id": 1,
            "panels": [],
            "title": "Container CPU",
            "type": "row"
        },
        {
            "datasource": {
                "type": "prometheus",
                "uid": "prometheus"
            },
            "description": "Container CPU usage.",
            "fieldConfig": {
                "defaults": {
                    "color": {
                        "mode": "palette-classic"
                    },
                    "unit": "percent"
                }
            },
            "gridPos": {
                "h": 8,
                "w": 24,
                "x": 0,
                "y": 1
            },
            "id": 2,
            "options": {},
            "targets": [
                {
                    "expr": "sum(rate(container_cpu_usage_seconds_total{namespace=~\"$namespace\", pod=~\"$pod\", container=~\"$container\"}[$__rate_interval])) by (pod, container) * 100",
                    "legendFormat": "{{pod}}/{{container}}"
                }
            ],
            "title": "CPU Usage",
            "type": "timeseries"
        },
        {
            "collapsed": false,
            "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 9
            },
            "id": 3,
            "panels": [],
            "title": "Container Memory",
            "type": "row"
        },
        {
            "datasource": {
                "type": "prometheus",
                "uid": "prometheus"
            },
            "description": "Container memory usage.",
            "fieldConfig": {
                "defaults": {
                    "color": {
                        "mode": "palette-classic"
                    },
                    "unit": "bytes"
                }
            },
            "gridPos": {
                "h": 8,
                "w": 12,
                "x": 0,
                "y": 10
            },
            "id": 4,
            "options": {},
            "targets": [
                {
                    "expr": "sum(container_memory_usage_bytes{namespace=~\"$namespace\", pod=~\"$pod\", container=~\"$container\"}) by (pod, container)",
                    "legendFormat": "{{pod}}/{{container}}"
                }
            ],
            "title": "Memory Usage",
            "type": "timeseries"
        },
        {
            "datasource": {
                "type": "prometheus",
                "uid": "prometheus"
            },
            "description": "Container memory working set.",
            "fieldConfig": {
                "defaults": {
                    "color": {
                        "mode": "palette-classic"
                    },
                    "unit": "bytes"
                }
            },
            "gridPos": {
                "h": 8,
                "w": 12,
                "x": 12,
                "y": 10
            },
            "id": 5,
            "options": {},
            "targets": [
                {
                    "expr": "sum(container_memory_working_set_bytes{namespace=~\"$namespace\", pod=~\"$pod\", container=~\"$container\"}) by (pod, container)",
                    "legendFormat": "{{pod}}/{{container}}"
                }
            ],
            "title": "Memory Working Set",
            "type": "timeseries"
        },
        {
            "collapsed": false,
            "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 18
            },
            "id": 6,
            "panels": [],
            "title": "Node",
            "type": "row"
        },
        {
            "datasource": {
                "type": "prometheus",
                "uid": "prometheus"
            },
            "description": "Node load average.",
            "fieldConfig": {
                "defaults": {
                    "color": {
                        "mode": "palette-classic"
                    }
                }
            },
            "gridPos": {
                "h": 8,
                "w": 24,
                "x": 0,
                "y": 19
            },
            "id": 7,
            "options": {},
            "targets": [
                {
                    "expr": "avg(node_load1{instance=~\"$instance\"}) by (instance)",
                    "legendFormat": "{{instance}} 1m"
                },
                {
                    "expr": "avg(node_load5{instance=~\"$instance\"}) by (instance)",
                    "legendFormat": "{{instance}} 5m"
                },
                {
                    "expr": "avg(node_load15{instance=~\"$instance\"}) by (instance)",
                    "legendFormat": "{{instance}} 15m"
                }
            ],
            "title": "Node Load Average",
            "type": "timeseries"
        },
        {
            "collapsed": false,
            "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 27
            },
            "id": 8,
            "panels": [],
            "title": "Pod & Container Health",
            "type": "row"
        },
        {
            "datasource": {
                "type": "prometheus",
                "uid": "prometheus"
            },
            "description": "CPU throttling events across all containers.",
            "fieldConfig": {
                "defaults": {
                    "color": {
                        "mode": "palette-classic"
                    },
                    "unit": "percentunit"
                }
            },
            "gridPos": {
                "h": 8,
                "w": 12,
                "x": 0,
                "y": 28
            },
            "id": 9,
            "options": {},
            "targets": [
                {
                    "expr": "sum(rate(container_cpu_cfs_throttled_seconds_total{namespace=~\"$namespace\", pod=~\"$pod\", container=~\"$container\"}[$__rate_interval])) by (pod, container) / sum(rate(container_cpu_cfs_periods_total{namespace=~\"$namespace\", pod=~\"$pod\", container=~\"$container\"}[$__rate_interval])) by (pod, container)",
                    "legendFormat": "{{pod}}/{{container}}"
                }
            ],
            "title": "CPU Throttling Rate",
            "type": "timeseries"
        },
        {
            "datasource": {
                "type": "prometheus",
                "uid": "prometheus"
            },
            "description": "Out of memory kill events detected.",
            "fieldConfig": {
                "defaults": {
                    "color": {
                        "mode": "palette-classic"
                    }
                }
            },
            "gridPos": {
                "h": 8,
                "w": 12,
                "x": 12,
                "y": 28
            },
            "id": 10,
            "options": {},
            "targets": [
                {
                    "expr": "sum(rate(container_oom_events_total{namespace=~\"$namespace\", pod=~\"$pod\", container=~\"$container\"}[$__rate_interval])) by (pod, container)",
                    "legendFormat": "{{pod}}/{{container}}"
                }
            ],
            "title": "OOM Kill Events",
            "type": "timeseries"
        },
        {
            "collapsed": false,
            "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 36
            },
            "id": 11,
            "panels": [],
            "title": "Resource Requests & Limits",
            "type": "row"
        },
        {
            "datasource": {
                "type": "prometheus",
                "uid": "prometheus"
            },
            "description": "Total number of running pods.",
            "fieldConfig": {
                "defaults": {
                    "color": {
                        "mode": "palette-classic"
                    }
                }
            },
            "gridPos": {
                "h": 8,
                "w": 8,
                "x": 0,
                "y": 37
            },
            "id": 12,
            "options": {},
            "targets": [
                {
                    "expr": "sum(kube_pod_status_phase{namespace=~\"$namespace\", phase=\"Running\", pod=~\"$pod\"}) by (pod)",
                    "legendFormat": "{{pod}}"
                }
            ],
            "title": "Total Running Pods",
            "type": "timeseries"
        },
        {
            "datasource": {
                "type": "prometheus",
                "uid": "prometheus"
            },
            "description": "CPU requests by service.",
            "fieldConfig": {
                "defaults": {
                    "color": {
                        "mode": "palette-classic"
                    }
                }
            },
            "gridPos": {
                "h": 8,
                "w": 8,
                "x": 8,
                "y": 37
            },
            "id": 13,
            "options": {},
            "targets": [
                {
                    "expr": "sum(kube_pod_container_resource_requests{namespace=~\"$namespace\", resource=\"cpu\", pod=~\"$pod\"}) by (pod)",
                    "legendFormat": "{{pod}}"
                }
            ],
            "title": "CPU Requests",
            "type": "timeseries"
        },
        {
            "datasource": {
                "type": "prometheus",
                "uid": "prometheus"
            },
            "description": "Memory requests by service.",
            "fieldConfig": {
                "defaults": {
                    "color": {
                        "mode": "palette-classic"
                    }
                }
            },
            "gridPos": {
                "h": 8,
                "w": 8,
                "x": 16,
                "y": 37
            },
            "id": 14,
            "options": {},
            "targets": [
                {
                    "expr": "sum(kube_pod_container_resource_requests{namespace=~\"$namespace\", resource=\"memory\", pod=~\"$pod\"}) by (pod)",
                    "legendFormat": "{{pod}}"
                }
            ],
            "title": "Memory Requests",
            "type": "timeseries"
        },
        {
            "collapsed": false,
            "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 45
            },
            "id": 15,
            "panels": [],
            "title": "Network Metrics",
            "type": "row"
        },
        {
            "datasource": {
                "type": "prometheus",
                "uid": "prometheus"
            },
            "description": "Network traffic received by containers.",
            "fieldConfig": {
                "defaults": {
                    "color": {
                        "mode": "palette-classic"
                    },
                    "unit": "bps"
                }
            },
            "gridPos": {
                "h": 8,
                "w": 12,
                "x": 0,
                "y": 46
            },
            "id": 16,
            "options": {},
            "targets": [
                {
                    "expr": "sum(rate(container_network_receive_bytes_total{namespace=~\"$namespace\", pod=~\"$pod\"}[$__rate_interval])) by (pod)",
                    "legendFormat": "{{pod}}"
                }
            ],
            "title": "Container Network Ingress",
            "type": "timeseries"
        },
        {
            "datasource": {
                "type": "prometheus",
                "uid": "prometheus"
            },
            "description": "Network traffic transmitted by containers.",
            "fieldConfig": {
                "defaults": {
                    "color": {
                        "mode": "palette-classic"
                    },
                    "unit": "bps"
                }
            },
            "gridPos": {
                "h": 8,
                "w": 12,
                "x": 12,
                "y": 46
            },
            "id": 17,
            "options": {},
            "targets": [
                {
                    "expr": "sum(rate(container_network_transmit_bytes_total{namespace=~\"$namespace\", pod=~\"$pod\"}[$__rate_interval])) by (pod)",
                    "legendFormat": "{{pod}}"
                }
            ],
            "title": "Container Network Egress",
            "type": "timeseries"
        },
        {
            "collapsed": false,
            "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 54
            },
            "id": 18,
            "panels": [],
            "title": "Node Network",
            "type": "row"
        },
        {
            "datasource": {
                "type": "prometheus",
                "uid": "prometheus"
            },
            "description": "Network traffic received by nodes.",
            "fieldConfig": {
                "defaults": {
                    "color": {
                        "mode": "palette-classic"
                    },
                    "unit": "bps"
                }
            },
            "gridPos": {
                "h": 8,
                "w": 12,
                "x": 0,
                "y": 55
            },
            "id": 19,
            "options": {},
            "targets": [
                {
                    "expr": "sum(rate(node_network_receive_bytes_total{instance=~\"$instance\"}[$__rate_interval])) by (instance)",
                    "legendFormat": "{{instance}}"
                }
            ],
            "title": "Node Network Ingress",
            "type": "timeseries"
        },
        {
            "datasource": {
                "type": "prometheus",
                "uid": "prometheus"
            },
            "description": "Network traffic transmitted by nodes.",
            "fieldConfig": {
                "defaults": {
                    "color": {
                        "mode": "palette-classic"
                    },
                    "unit": "bps"
                }
            },
            "gridPos": {
                "h": 8,
                "w": 12,
                "x": 12,
                "y": 55
            },
            "id": 20,
            "options": {},
            "targets": [
                {
                    "expr": "sum(rate(node_network_transmit_bytes_total{instance=~\"$instance\"}[$__rate_interval])) by (instance)",
                    "legendFormat": "{{instance}}"
                }
            ],
            "title": "Node Network Egress",
            "type": "timeseries"
        },
        {
            "collapsed": false,
            "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 63
            },
            "id": 21,
            "panels": [],
            "title": "Sockets & Connections",
            "type": "row"
        },
        {
            "datasource": {
                "type": "prometheus",
                "uid": "prometheus"
            },
            "description": "Number of open sockets by container.",
            "fieldConfig": {
                "defaults": {
                    "color": {
                        "mode": "palette-classic"
                    }
                }
            },
            "gridPos": {
                "h": 8,
                "w": 12,
                "x": 0,
                "y": 64
            },
            "id": 22,
            "options": {},
            "targets": [
                {
                    "expr": "sum(container_sockets{namespace=~\"$namespace\", pod=~\"$pod\"}) by (pod)",
                    "legendFormat": "{{pod}}"
                }
            ],
            "title": "Container Sockets",
            "type": "timeseries"
        },
        {
            "datasource": {
                "type": "prometheus",
                "uid": "prometheus"
            },
            "description": "Number of sockets in use on nodes.",
            "fieldConfig": {
                "defaults": {
                    "color": {
                        "mode": "palette-classic"
                    }
                }
            },
            "gridPos": {
                "h": 8,
                "w": 12,
                "x": 12,
                "y": 64
            },
            "id": 23,
            "options": {},
            "targets": [
                {
                    "expr": "node_sockstat_sockets_used{instance=~\"$instance\"}",
                    "legendFormat": "{{instance}}"
                }
            ],
            "title": "Node Sockets Used",
            "type": "timeseries"
        },
        {
            "collapsed": false,
            "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 72
            },
            "id": 24,
            "panels": [],
            "title": "Filesystem & I/O",
            "type": "row"
        },
        {
            "datasource": {
                "type": "prometheus",
                "uid": "prometheus"
            },
            "description": "Container filesystem read bytes total.",
            "fieldConfig": {
                "defaults": {
                    "color": {
                        "mode": "palette-classic"
                    },
                    "unit": "bytes"
                }
            },
            "gridPos": {
                "h": 8,
                "w": 12,
                "x": 0,
                "y": 73
            },
            "id": 25,
            "options": {},
            "targets": [
                {
                    "expr": "sum(rate(container_fs_reads_bytes_total{namespace=~\"$namespace\", pod=~\"$pod\", container=~\"$container\"}[$__rate_interval])) by (pod, container)",
                    "legendFormat": "{{pod}}/{{container}}"
                }
            ],
            "title": "Container FS Read Bytes",
            "type": "timeseries"
        },
        {
            "datasource": {
                "type": "prometheus",
                "uid": "prometheus"
            },
            "description": "Container filesystem write bytes total.",
            "fieldConfig": {
                "defaults": {
                    "color": {
                        "mode": "palette-classic"
                    },
                    "unit": "bytes"
                }
            },
            "gridPos": {
                "h": 8,
                "w": 12,
                "x": 12,
                "y": 73
            },
            "id": 26,
            "options": {},
            "targets": [
                {
                    "expr": "sum(rate(container_fs_writes_bytes_total{namespace=~\"$namespace\", pod=~\"$pod\", container=~\"$container\"}[$__rate_interval])) by (pod, container)",
                    "legendFormat": "{{pod}}/{{container}}"
                }
            ],
            "title": "Container FS Write Bytes",
            "type": "timeseries"
        },
        {
            "datasource": {
                "type": "prometheus",
                "uid": "prometheus"
            },
            "description": "Node filesystem usage.",
            "fieldConfig": {
                "defaults": {
                    "color": {
                        "mode": "palette-classic"
                    },
                    "unit": "bytes"
                }
            },
            "gridPos": {
                "h": 8,
                "w": 12,
                "x": 0,
                "y": 81
            },
            "id": 27,
            "options": {},
            "targets": [
                {
                    "expr": "node_filesystem_size_bytes{instance=~\"$instance\"} - node_filesystem_free_bytes{instance=~\"$instance\"}",
                    "legendFormat": "{{instance}} Used"
                },
                {
                    "expr": "node_filesystem_size_bytes{instance=~\"$instance\"}",
                    "legendFormat": "{{instance}} Total"
                }
            ],
            "title": "Node Filesystem Usage",
            "type": "timeseries"
        },
        {
            "datasource": {
                "type": "prometheus",
                "uid": "prometheus"
            },
            "description": "Node disk I/O.",
            "fieldConfig": {
                "defaults": {
                    "color": {
                        "mode": "palette-classic"
                    },
                    "unit": "pps"
                }
            },
            "gridPos": {
                "h": 8,
                "w": 12,
                "x": 12,
                "y": 81
            },
            "id": 28,
            "options": {},
            "targets": [
                {
                    "expr": "sum(rate(node_vmstat_pgpgin{instance=~\"$instance\"}[$__rate_interval])) by (instance)",
                    "legendFormat": "{{instance}} pages in"
                },
                {
                    "expr": "sum(rate(node_vmstat_pgpgout{instance=~\"$instance\"}[$__rate_interval])) by (instance)",
                    "legendFormat": "{{instance}} pages out"
                }
            ],
            "title": "Node Disk I/O",
            "type": "timeseries"
        },
        {
            "collapsed": false,
            "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 89
            },
            "id": 29,
            "panels": [],
            "title": "File Descriptors",
            "type": "row"
        },
        {
            "datasource": {
                "type": "prometheus",
                "uid": "prometheus"
            },
            "description": "Number of open file descriptors by container.",
            "fieldConfig": {
                "defaults": {
                    "color": {
                        "mode": "palette-classic"
                    }
                }
            },
            "gridPos": {
                "h": 8,
                "w": 12,
                "x": 0,
                "y": 90
            },
            "id": 30,
            "options": {},
            "targets": [
                {
                    "expr": "container_file_descriptors{namespace=~\"$namespace\", pod=~\"$pod\", container=~\"$container\"}",
                    "legendFormat": "{{pod}}/{{container}}"
                },
                {
                    "expr": "max(container_ulimits_soft{namespace=~\"$namespace\", pod=~\"$pod\", container=~\"$container\", ulimit=\"nofile\"}) by (pod, container)",
                    "legendFormat": "{{pod}}/{{container}} Limit"
                }
            ],
            "title": "Container File Descriptors",
            "type": "timeseries"
        },
        {
            "datasource": {
                "type": "prometheus",
                "uid": "prometheus"
            },
            "description": "Number of open file descriptors by process.",
            "fieldConfig": {
                "defaults": {
                    "color": {
                        "mode": "palette-classic"
                    }
                }
            },
            "gridPos": {
                "h": 8,
                "w": 12,
                "x": 12,
                "y": 90
            },
            "id": 31,
            "options": {},
            "targets": [
                {
                    "expr": "process_open_fds{job=\"node-exporter\", instance=~\"$instance\"}",
                    "legendFormat": "{{instance}} Used"
                },
                {
                    "expr": "process_max_fds{job=\"node-exporter\", instance=~\"$instance\"}",
                    "legendFormat": "{{instance}} Available"
                }
            ],
            "title": "Process File Descriptors",
            "type": "timeseries"
        },
        {
            "collapsed": false,
            "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 98
            },
            "id": 32,
            "panels": [],
            "title": "Node TCP/Sockets",
            "type": "row"
        },
        {
            "datasource": {
                "type": "prometheus",
                "uid": "prometheus"
            },
            "description": "Current TCP connections on nodes.",
            "fieldConfig": {
                "defaults": {
                    "color": {
                        "mode": "palette-classic"
                    }
                }
            },
            "gridPos": {
                "h": 8,
                "w": 12,
                "x": 0,
                "y": 99
            },
            "id": 33,
            "options": {},
            "targets": [
                {
                    "expr": "node_netstat_Tcp_CurrEstab{instance=~\"$instance\"}",
                    "legendFormat": "{{instance}} Established"
                },
                {
                    "expr": "node_netstat_Tcp_ActiveOpens{instance=~\"$instance\"}",
                    "legendFormat": "{{instance}} Active Opens"
                },
                {
                    "expr": "node_netstat_Tcp_PassiveOpens{instance=~\"$instance\"}",
                    "legendFormat": "{{instance}} Passive Opens"
                }
            ],
            "title": "Node TCP Connections",
            "type": "timeseries"
        },
        {
            "datasource": {
                "type": "prometheus",
                "uid": "prometheus"
            },
            "description": "TCP socket statistics on nodes.",
            "fieldConfig": {
                "defaults": {
                    "color": {
                        "mode": "palette-classic"
                    }
                }
            },
            "gridPos": {
                "h": 8,
                "w": 12,
                "x": 12,
                "y": 99
            },
            "id": 34,
            "options": {},
            "targets": [
                {
                    "expr": "node_sockstat_TCP_inuse{instance=~\"$instance\"}",
                    "legendFormat": "{{instance}} In Use"
                },
                {
                    "expr": "node_sockstat_TCP_alloc{instance=~\"$instance\"}",
                    "legendFormat": "{{instance}} Allocated"
                },
                {
                    "expr": "node_sockstat_TCP_mem_bytes{instance=~\"$instance\"}",
                    "legendFormat": "{{instance}} Memory"
                }
            ],
            "title": "Node TCP Socket Stats",
            "type": "timeseries"
        },
        {
            "collapsed": false,
            "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 107
            },
            "id": 35,
            "panels": [],
            "title": "Filesystem (Inodes)",
            "type": "row"
        },
        {
            "datasource": {
                "type": "prometheus",
                "uid": "prometheus"
            },
            "description": "Total and free inodes for containers.",
            "fieldConfig": {
                "defaults": {
                    "color": {
                        "mode": "palette-classic"
                    }
                }
            },
            "gridPos": {
                "h": 8,
                "w": 12,
                "x": 0,
                "y": 108
            },
            "id": 36,
            "options": {},
            "targets": [
                {
                    "expr": "sum(container_fs_inodes_total{namespace=~\"$namespace\"}) by (instance)",
                    "legendFormat": "{{instance}} Total"
                },
                {
                    "expr": "sum(container_fs_inodes_free{namespace=~\"$namespace\"}) by (instance)",
                    "legendFormat": "{{instance}} Free"
                }
            ],
            "title": "Container Filesystem Inodes",
            "type": "timeseries"
        },
        {
            "datasource": {
                "type": "prometheus",
                "uid": "prometheus"
            },
            "description": "Total and free inodes for nodes.",
            "fieldConfig": {
                "defaults": {
                    "color": {
                        "mode": "palette-classic"
                    }
                }
            },
            "gridPos": {
                "h": 8,
                "w": 12,
                "x": 12,
                "y": 108
            },
            "id": 37,
            "options": {},
            "targets": [
                {
                    "expr": "node_filesystem_files{instance=~\"$instance\"}",
                    "legendFormat": "{{instance}} Total"
                },
                {
                    "expr": "node_filesystem_files_free{instance=~\"$instance\"}",
                    "legendFormat": "{{instance}} Free"
                }
            ],
            "title": "Node Filesystem Inodes",
            "type": "timeseries"
        },
        {
            "collapsed": false,
            "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 116
            },
            "id": 38,
            "panels": [],
            "title": "Memory Details",
            "type": "row"
        },
        {
            "datasource": {
                "type": "prometheus",
                "uid": "prometheus"
            },
            "description": "Detailed memory usage for nodes.",
            "fieldConfig": {
                "defaults": {
                    "color": {
                        "mode": "palette-classic"
                    },
                    "unit": "bytes"
                }
            },
            "gridPos": {
                "h": 8,
                "w": 12,
                "x": 0,
                "y": 117
            },
            "id": 39,
            "options": {},
            "targets": [
                {
                    "expr": "node_memory_MemTotal_bytes{instance=~\"$instance\"}",
                    "legendFormat": "{{instance}} Total"
                },
                {
                    "expr": "node_memory_MemFree_bytes{instance=~\"$instance\"}",
                    "legendFormat": "{{instance}} Free"
                },
                {
                    "expr": "node_memory_Cached_bytes{instance=~\"$instance\"}",
                    "legendFormat": "{{instance}} Cached"
                },
                {
                    "expr": "node_memory_Buffers_bytes{instance=~\"$instance\"}",
                    "legendFormat": "{{instance}} Buffers"
                }
            ],
            "title": "Node Memory Details",
            "type": "timeseries"
        },
        {
            "datasource": {
                "type": "prometheus",
                "uid": "prometheus"
            },
            "description": "Detailed memory usage for containers.",
            "fieldConfig": {
                "defaults": {
                    "color": {
                        "mode": "palette-classic"
                    },
                    "unit": "bytes"
                }
            },
            "gridPos": {
                "h": 8,
                "w": 12,
                "x": 12,
                "y": 117
            },
            "id": 40,
            "options": {},
            "targets": [
                {
                    "expr": "container_memory_cache{namespace=~\"$namespace\", pod=~\"$pod\", container=~\"$container\"}",
                    "legendFormat": "{{pod}}/{{container}} Cache"
                },
                {
                    "expr": "container_memory_rss{namespace=~\"$namespace\", pod=~\"$pod\", container=~\"$container\"}",
                    "legendFormat": "{{pod}}/{{container}} RSS"
                },
                {
                    "expr": "container_memory_swap{namespace=~\"$namespace\", pod=~\"$pod\", container=~\"$container\"}",
                    "legendFormat": "{{pod}}/{{container}} Swap"
                }
            ],
            "title": "Container Memory Details",
            "type": "timeseries"
        },
        {
            "collapsed": false,
            "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 125
            },
            "id": 41,
            "panels": [],
            "title": "Node I/O Pressure",
            "type": "row"
        },
        {
            "datasource": {
                "type": "prometheus",
                "uid": "prometheus"
            },
            "description": "Node I/O pressure.",
            "fieldConfig": {
                "defaults": {
                    "color": {
                        "mode": "palette-classic"
                    },
                    "unit": "s"
                }
            },
            "gridPos": {
                "h": 8,
                "w": 24,
                "x": 0,
                "y": 126
            },
            "id": 42,
            "options": {},
            "targets": [
                {
                    "expr": "sum(rate(node_pressure_io_waiting_seconds_total{instance=~\"$instance\"}[$__rate_interval])) by (instance)",
                    "legendFormat": "{{instance}} waiting"
                },
                {
                    "expr": "sum(rate(node_pressure_io_stalled_seconds_total{instance=~\"$instance\"}[$__rate_interval])) by (instance)",
                    "legendFormat": "{{instance}} stalled"
                }
            ],
            "title": "Node I/O Pressure",
            "type": "timeseries"
        },
        {
            "collapsed": false,
            "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 134
            },
            "id": 43,
            "panels": [],
            "title": "Node TCP Errors & Retransmissions",
            "type": "row"
        },
        {
            "datasource": {
                "type": "prometheus",
                "uid": "prometheus"
            },
            "description": "Node TCP/UDP errors.",
            "fieldConfig": {
                "defaults": {
                    "color": {
                        "mode": "palette-classic"
                    }
                }
            },
            "gridPos": {
                "h": 8,
                "w": 8,
                "x": 0,
                "y": 135
            },
            "id": 44,
            "options": {},
            "targets": [
                {
                    "expr": "sum(rate(node_netstat_Tcp_InErrs{instance=~\"$instance\"}[$__rate_interval])) by (instance)",
                    "legendFormat": "{{instance}} TCP In Errors"
                },
                {
                    "expr": "sum(rate(node_netstat_Udp_InErrors{instance=~\"$instance\"}[$__rate_interval])) by (instance)",
                    "legendFormat": "{{instance}} UDP In Errors"
                }
            ],
            "title": "Node TCP/UDP Errors",
            "type": "timeseries"
        },
        {
            "datasource": {
                "type": "prometheus",
                "uid": "prometheus"
            },
            "description": "Node TCP retransmissions.",
            "fieldConfig": {
                "defaults": {
                    "color": {
                        "mode": "palette-classic"
                    }
                }
            },
            "gridPos": {
                "h": 8,
                "w": 8,
                "x": 8,
                "y": 135
            },
            "id": 45,
            "options": {},
            "targets": [
                {
                    "expr": "sum(rate(node_netstat_Tcp_RetransSegs{instance=~\"$instance\"}[$__rate_interval])) by (instance)",
                    "legendFormat": "{{instance}}"
                }
            ],
            "title": "Node TCP Retransmissions",
            "type": "timeseries"
        },
        {
            "datasource": {
                "type": "prometheus",
                "uid": "prometheus"
            },
            "description": "Node TCP listen drops and overflows.",
            "fieldConfig": {
                "defaults": {
                    "color": {
                        "mode": "palette-classic"
                    }
                }
            },
            "gridPos": {
                "h": 8,
                "w": 8,
                "x": 16,
                "y": 135
            },
            "id": 46,
            "options": {},
            "targets": [
                {
                    "expr": "sum(rate(node_netstat_TcpExt_ListenDrops{instance=~\"$instance\"}[$__rate_interval])) by (instance)",
                    "legendFormat": "{{instance}} Drops"
                },
                {
                    "expr": "sum(rate(node_netstat_TcpExt_ListenOverflows{instance=~\"$instance\"}[$__rate_interval])) by (instance)",
                    "legendFormat": "{{instance}} Overflows"
                }
            ],
            "title": "Node TCP Listen Drops & Overflows",
            "type": "timeseries"
        },
        {
            "collapsed": false,
            "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 143
            },
            "id": 47,
            "panels": [],
            "title": "Node Swap",
            "type": "row"
        },
        {
            "datasource": {
                "type": "prometheus",
                "uid": "prometheus"
            },
            "description": "Node swap usage.",
            "fieldConfig": {
                "defaults": {
                    "color": {
                        "mode": "palette-classic"
                    },
                    "unit": "bytes"
                }
            },
            "gridPos": {
                "h": 8,
                "w": 24,
                "x": 0,
                "y": 144
            },
            "id": 48,
            "options": {},
            "targets": [
                {
                    "expr": "node_memory_SwapTotal_bytes{instance=~\"$instance\"}",
                    "legendFormat": "{{instance}} Total"
                },
                {
                    "expr": "node_memory_SwapFree_bytes{instance=~\"$instance\"}",
                    "legendFormat": "{{instance}} Free"
                }
            ],
            "title": "Node Swap Usage",
            "type": "timeseries"
        },
        {
            "collapsed": false,
            "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 152
            },
            "id": 49,
            "panels": [],
            "title": "Container I/O",
            "type": "row"
        },
        {
            "datasource": {
                "type": "prometheus",
                "uid": "prometheus"
            },
            "description": "Container filesystem I/O time.",
            "fieldConfig": {
                "defaults": {
                    "color": {
                        "mode": "palette-classic"
                    },
                    "unit": "s"
                }
            },
            "gridPos": {
                "h": 8,
                "w": 24,
                "x": 0,
                "y": 153
            },
            "id": 50,
            "options": {},
            "targets": [
                {
                    "expr": "sum(rate(container_fs_io_time_seconds_total{namespace=~\"$namespace\"}[$__rate_interval])) by (instance)",
                    "legendFormat": "{{instance}}"
                }
            ],
            "title": "Container FS I/O Time",
            "type": "timeseries"
        }
    ],
    "refresh": "30s",
    "schemaVersion": 38,
    "style": "dark",
    "tags": [
        "countly",
        "infrastructure"
    ],
    "templating": {
        "list": [
            {
                "current": {
                    "selected": true,
                    "text": "countly",
                    "value": "countly"
                },
                "datasource": {
                    "type": "prometheus",
                    "uid": "prometheus"
                },
                "definition": "label_values(kube_pod_info, namespace)",
                "hide": 0,
                "includeAll": true,
                "label": "Namespace",
                "multi": true,
                "name": "namespace",
                "options": [],
                "query": {
                    "query": "label_values(kube_pod_info, namespace)",
                    "refId": "StandardVariableQuery"
                },
                "refresh": 2,
                "regex": "",
                "skipUrlSync": false,
                "sort": 1,
                "type": "query"
            },
            {
                "current": {
                    "selected": false,
                    "text": "All",
                    "value": "$__all"
                },
                "datasource": {
                    "type": "prometheus",
                    "uid": "prometheus"
                },
                "definition": "label_values(kube_pod_info{namespace=~\"$namespace\"}, pod)",
                "hide": 0,
                "includeAll": true,
                "label": "Service",
                "multi": true,
                "name": "pod",
                "options": [],
                "query": {
                    "query": "label_values(kube_pod_info{namespace=~\"$namespace\"}, pod)",
                    "refId": "StandardVariableQuery"
                },
                "refresh": 2,
                "regex": "/^countly-.*/",
                "skipUrlSync": false,
                "sort": 1,
                "type": "query"
            },
            {
                "current": {
                    "selected": false,
                    "text": "All",
                    "value": "$__all"
                },
                "datasource": {
                    "type": "prometheus",
                    "uid": "prometheus"
                },
                "definition": "label_values(kube_pod_container_info{namespace=~\"$namespace\", pod=~\"$pod\"}, container)",
                "hide": 0,
                "includeAll": true,
                "label": "Container",
                "multi": true,
                "name": "container",
                "options": [],
                "query": {
                    "query": "label_values(kube_pod_container_info{namespace=~\"$namespace\", pod=~\"$pod\"}, container)",
                    "refId": "StandardVariableQuery"
                },
                "refresh": 2,
                "regex": "",
                "skipUrlSync": false,
                "sort": 1,
                "type": "query"
            },
            {
                "current": {
                    "selected": false,
                    "text": "All",
                    "value": "$__all"
                },
                "datasource": {
                    "type": "prometheus",
                    "uid": "prometheus"
                },
                "definition": "label_values(node_load1, instance)",
                "hide": 0,
                "includeAll": true,
                "label": "Instance",
                "multi": true,
                "name": "instance",
                "options": [],
                "query": {
                    "query": "label_values(node_load1, instance)",
                    "refId": "StandardVariableQuery"
                },
                "refresh": 2,
                "regex": "",
                "skipUrlSync": false,
                "sort": 1,
                "type": "query"
            }
        ]
    },
    "time": {
        "from": "now-1h",
        "to": "now"
    },
    "timepicker": {},
    "timezone": "",
    "title": "New Infrastructure Metrics",
    "uid": "new-infrastructure-metrics",
    "version": 1
}